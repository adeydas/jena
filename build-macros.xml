<project xmlns:ivy="antlib:org.apache.ivy.ant" name="macros">


  <macrodef name="once">
    <attribute name="target"/>
    <attribute name="marker"/>
    <sequential>
      <antcall name="@{target}"/>
      <property name="@{marker}" value="[done]"/>
    </sequential>
  </macrodef>
    

  <macrodef name="publish-module">
   <attribute name="ivy.file"/>
   <attribute name="resolver" default="dev-publish"/>
   
   <sequential>
     <ivy:resolve file="@{ivy.file}"/>
     <ivy:publish conf="main" 
		  resolver="@{resolver}" 
		  overwrite="true"
		  forcedeliver="true">
       <artifacts pattern="${artifacts.dir}/[artifact]-[revision](-[classifier]).[ext]" />
     </ivy:publish>
   </sequential>
  </macrodef>


</project>