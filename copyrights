#!/usr/bin/perl
# Find copyright statements in a file.
# Run with: find src -name \*.java | xargs perl SCRIPT | sort | uniq 
# to get all the copyright statements in the source tree.

&setExclude ;
undef $/ ;

while(defined($file = shift @ARGV))
{
    # Excludes
    next if ( defined($exclude{$file}) ) ;
    &process($file) ;
}

sub process
{
    my $file = @_[0] ;
    open(FILE, "<$file") || die ;
    binmode FILE ;
    $_ = <FILE> ;
    my @a = &copyrights($_) ;
    map {$copyrights{$_} = $file} @a ;
    print join("\n", keys %copyrights),"\n" ;
}

sub copyrights
{
     my $text = @_[0] ;
     my @a = m!\(c\)\s*Copyright(?:[\s\d,]*)(.*)!gx ;
     return @a ;
}

sub setExclude
{
    # Typically generated files.
}
