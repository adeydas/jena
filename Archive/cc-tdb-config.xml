<cruisecontrol>
  <!-- Copy this file to CC/projects/cc-afs-config.xml
       Put this in cruisecontrol config.xml
       <include.projects file="projects/cc-afs-config.xml"/>
  -->

  <!-- <property name="cc.workdir.dir" value="/srv/cruisecontrol" /> -->

  <!-- Crusiecontrol properties (launcher)
    <property name="cc.home" value=""/> 
    <property name="cc.dist.dir" value=""/> 
    <property name="cc.library.dir" value=""/> 
    <property name="user.home" value=""/> 
  -->
  <!-- Directories relative to the CC base -->

  <!-- Dashboard -->
  <property name="cc.logdir"      value="logs"/>
  <property name="cc.artifacts"   value="artifacts"/>
  <property name="cc.projects"    value="projects"/>

  <project name="TDB" requiremodification="true">
    <property name="project.name"   value="TDB"/>
    <property name="project.home"   value="projects/${project.name}"/>
    <property name="logs.base"      value="${cc.logdir}/${project.name}"/>

    <!-- Defines where cruisecontrol looks for changes, to decide whether to run the build -->

    <modificationset quietperiod="10">
      <svn LocalWorkingCopy="${project.home}"
           RepositoryLocation="http://jena.svn.sourceforge.net/svnroot/jena/Scratch/AFS/trunk"/>
    </modificationset>

    <!-- Configures the actual build loop, how often and which build file/target -->
    <schedule interval="300">
      <composite>
        <!-- Get changes -->
        <exec command="svn"
              args="update"
              workingdir="${project.home}"/>
        <!-- MUST ensure ant can find ant-junit.jar : either point to 
             anthome or place in lib/ for CruiseControl
        -->
        <ant anthome="/home/afs/sys/apache-ant-1.7.0"
             antWorkingDir="${project.home}"
             target="report"
             />
      </composite>
    </schedule>

    <log dir="${logs.base}">
      <merge dir="${project.home}/reports"/>
      <delete every="1" unit="DAY" ignoreSuffix="xml"/>
    </log>

    <listeners>
      <currentbuildstatuslistener file="${logs.base}/buildstatus.txt"/>
    </listeners>

    <!-- Publishers are run *after* a build completes -->
    <publishers>
      <artifactspublisher subdirectory="reports" 
                          dest="${cc.artifacts}/${project.name}" 
                          dir="${project.home}/reports"/>
      <!--
      <onsuccess>
      </onsuccess>
      -->
    </publishers>
  </project>
</cruisecontrol>
